<!doctype html>
<html>

<head>
  <%- include('layout/meta') -%>

</head>

<body data-anm=".anm">

  <div class="wrapper">
    <%- include('layout/header') %>

    <div id="main-content">

      <div class="inner-header">
        <div class="container">
          <h1>Wishlist</h1>
          <div class="breadcrums">
            <a href="/">Home</a>
            <a href="javascript:void(0);">Wishlist</a>
          </div>
        </div>
        <div class="curv-svg">
          <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px"
            y="0px" viewBox="0 0 1439 39.7" style="enable-background:new 0 0 1439 39.7;" xml:space="preserve">
            <path
              d="M749.5,39.7c-12,0-24,0-36,0c-1.5-0.2-2.9-0.4-4.4-0.5c-43.6-1.7-85.9-7.6-127.2-16.6c-18-3.9-36.3-7-55.3-7.9
                c-36.2-1.8-71.7,1.4-107.2,5.5c-22.7,2.6-45.3,6-68.2,7.9c-28.4,2.3-57,3.5-85.5,4.8c-42.2,1.8-84.2,0.4-125.7-5.1
                c-41.6-5.5-83.5-8.3-126-6.6C9.5,21.4,4.9,21.6,0,21.8C0,14.3,0,7.1,0,0c479.7,0,959.3,0,1439,0c0,6.8,0,13.7,0,20.5
                c-20.1,2.9-40.1,6-60.3,8.7c-36.2,4.7-72.5,5.4-109.2,1.8c-35.1-3.4-69.6-8.4-103.8-14.1c-32.9-5.5-66-10.1-99.9-11.7
                c-38.9-1.9-77.8-2.2-116.6,0.6c-35.9,2.6-70.7,7.6-103.2,18.3c-22.5,7.4-46.7,11.6-71.8,13.8C765.9,38.5,757.7,39.1,749.5,39.7z" />
          </svg>

        </div>
      </div>

      <section class="contact-section inner-about-section">
        <div class="pos-abs red-green-chilli" data-aos="fade-right">
          <img src="images/assets/chilli.png" alt="Maruti Munchies" />
        </div>
        <div class="pos-abs abt-wheat-abs" data-aos="fade-left"><img src="images/assets/wheat-9.png"
            alt="Maruti Munchise" /></div>
        <div class="container">

          <section class="mt-50 mb-50">
            <div class="container">
              <div class="row">
                <div class="col-12" data-aos="fade-up">
                  <div class="table-responsive">
                    <table class="table shopping-summery text-center">
                      <thead>
                        <tr class="main-heading">
                          <th scope="col" colspan="2">Product</th>
                          <th scope="col">Price</th>
                          <th scope="col">Stock Status</th>
                          <th scope="col">Action</th>
                          <th scope="col">Remove</th>
                        </tr>
                      </thead>
                      <tbody>
                        <% if(wishlist.length === 0) { %>
                          <tr>
                            <td colspan="6">No Items in Wishlist</td>
                          </tr>
                        <% } else{ %>
                          <% wishlist.forEach((row, index) => { %>
                            <tr>
                              <td class="image product-thumbnail"><img src="<%=row.product_image %>" alt="#">
                              </td>
                              <td class="product-des product-name">
                                <h5 class="product-name"><a href="javascript:void(0)"><%= row.product_name %></a></h5>
                                <p class="font-xs"><%= row.product_description %>
                                </p>
                              </td>
                              <td class="price" data-title="Price"><span>₹ <%= row.product_price %> </span></td>
                              <td class="text-center" data-title="Stock">
                                <span class="color3 font-weight-bold">
                                  
                                  <% if(parseInt(row.product_quantity) > 0){ %>
                                    In Stock
                                  <%} else{ %>
                                    Out of Stock
                                  <% } %>
                                </span>
                              </td>
                              <td class="text-right" data-title="Cart">
                                <% if(parseInt(row.product_quantity) > 0){ %>
                                  <a href="#" class="btn btn-sm add_cart" pro_id="<%=row.product_id%>"><i class="fi-rs-shopping-bag mr-5"></i>Add to cart</a>
                                <%} else{ %>
                                  
                                <% } %>
                                
                              </td>
                              <td class="action" data-title="Remove"><a href="#" onclick="confirmFirst('<%=row.product_id%>')"><i class="fa-regular fa-trash-can"></i></a>
                            </tr>
                          <% }) %>
                        <% }%>
                        
                        
                        
                      </tbody>
                    </table>
                  </div>

                </div>
              </div>
            </div>
          </section>
        </div>
      </section>

      <div class="clearfix"></div>
    </div>
    
    <%- include('layout/footer') %>

    <div class="go-top-area">
      <div class="go-top-wrap">
        <div class="go-top-btn-wrap">
          <div class="go-top go-top-btn">
            <i class="fa fa-angle-double-up"></i>
            <i class="fa fa-angle-double-up"></i>
          </div>
        </div>
      </div>
    </div>

  </div>

  <%- include('layout/scripts') -%>
</body>

</html>

<script>
  function confirmFirst(id){
   var id = id;
    Swal.fire({
      title: "Are You sure want to delete?",
      // showDenyButton: true,
      showCancelButton: true,
      confirmButtonText: "Delete",
    }).then((result) => {
      /* Read more about isConfirmed, isDenied below */
      if (result.isConfirmed) {
        $.ajax({
          url : '/delete_from_wishlist',
          method : 'post',
          data : {'id' : id},
          success : function(data){
            // alert(data)
            location.reload();
          }
        })
        Swal.fire("Deleted!", "", "success");
      } else if (result.isDenied) {
        Swal.fire("Changes are not saved", "", "info");
      }
    });
  }

  $('.add_cart').click(function(e){
        var id = $(this).attr('pro_id');
        // alert(id)
        var arr = {id:id};
        $.ajax({
            url: "/add_cart",
            method: "post",
            data: {'id' : id},
            success: function(msg) {
                // alert(msg.row)
                $('#total_item_cart').text(msg.total_items)
                $('#row').html(msg.row)
                $('#total_amount').text("₹ "+msg.total)
                Swal.fire({
                    title: "Good job!",
                    text: "Product Added to cart!",
                    icon: "success",
                    confirmButtonColor: "#500800",
                });
               
            }
        });
        
    })
</script>